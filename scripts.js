// Shape+ — simple interactivity and i18n
const i18n = {
  "pt-BR": {
    "nav.features":"Recursos","nav.how":"Como funciona","nav.plans":"Planos","nav.testimonials":"Depoimentos","nav.getApp":"Baixar",
    "hero.title":"Perca peso sem dietas radicais — com plano personalizado","hero.subtitle":"Shape+ combina nutrição, micro-hábitos e feedback diário para resultados reais. Sincronize com Apple Health e Google Fit.","hero.ctaPrimary":"Baixar agora","hero.ctaSecondary":"Como funciona",
    "hero.b1":"Planos adaptativos baseados no seu histórico","hero.b2":"Registro rápido de refeições e scanner de códigos","hero.b3":"Integração com wearables e gráficos de progresso",
    "trust.users":"Usuários ativos","trust.rating":"Avaliação média","trust.results":"Redução média de peso em 8 semanas",
    "how.title":"Como funciona","how.subtitle":"Do onboarding ao progresso: simples, diário e eficaz.",
    "how.step1.title":"Onboarding rápido","how.step1.desc":"Informe objetivos, rotina e preferências — o Shape+ cria seu ponto de partida.",
    "how.step2.title":"Plano adaptativo","how.step2.desc":"Calorias alvo, micro-hábitos e refeições sugeridas que se ajustam conforme você evolui.",
    "how.step3.title":"Tracking inteligente","how.step3.desc":"Registre refeições, sincronize passos e sono; receba feedback e recomendações diárias.",
    "features.title":"Recursos principais","features.subtitle":"Tudo o que você precisa para perder peso de forma sustentável.",
    "features.f1.title":"Plano personalizado","features.f1.desc":"Metas e refeições adaptadas ao seu metabolismo e rotina.",
    "features.f2.title":"Registro rápido","features.f2.desc":"Entrada de alimentos em 3 segundos e scanner de código de barras.",
    "features.f3.title":"Integração com wearables","features.f3.desc":"Sincronize passos, calorias queimadas e sono automaticamente.",
    "features.f4.title":"Micro-hábitos","features.f4.desc":"Pequenas ações diárias que geram grandes resultados no longo prazo.",
    "features.f5.title":"Relatórios visuais","features.f5.desc":"Gráficos e progresso por coorte para entender sua evolução.",
    "features.f6.title":"Privacidade & segurança","features.f6.desc":"Criptografia em trânsito e em repouso; exporte ou exclua seus dados a qualquer momento.",
    "testimonials.title":"O que os usuários dizem",
    "plans.title":"Planos","plans.subtitle":"Comece grátis — atualize para recursos avançados.",
    "plans.free":"Grátis","plans.free1":"Registro de refeições","plans.free2":"Acompanhamento de peso","plans.free3":"1 micro-hábito personalizado","plans.startFree":"Começar grátis",
    "plans.premium":"Premium","plans.premium1":"Tudo do grátis","plans.premium2":"Planos alimentares adaptativos","plans.premium3":"Relatórios avançados","plans.subscribe":"Assinar Premium",
    "plans.coaching":"Coaching","plans.coaching1":"Coach dedicado","plans.coaching2":"Plano alimentar & treino","plans.contact":"Quero saber mais",
    "download.title":"Pronto para começar?","download.subtitle":"Baixe Shape+ e inicie sua jornada. Teste grátis por 7 dias no plano Premium.","download.beta":"Prefere testar em beta? Inscreva-se","lead.title":"Receba o link","lead.send":"Enviar link","lead.note":"Enviaremos o link e novidades para seu e-mail.",
    "modal.title":"Como deseja obter o app?"
  },
  "en":{
    "nav.features":"Features","nav.how":"How it works","nav.plans":"Pricing","nav.testimonials":"Testimonials","nav.getApp":"Get app",
    "hero.title":"Lose weight without extreme diets — personalized plans","hero.subtitle":"Shape+ combines nutrition, micro-habits and daily feedback for real results. Sync with Apple Health & Google Fit.","hero.ctaPrimary":"Download now","hero.ctaSecondary":"How it works",
    "hero.b1":"Adaptive plans based on your history","hero.b2":"Fast meal logging & barcode scanner","hero.b3":"Wearables integration and progress charts",
    "trust.users":"Active users","trust.rating":"Avg rating","trust.results":"Avg weight reduction in 8 weeks",
    "how.title":"How it works","how.subtitle":"From onboarding to progress: simple, daily and effective.",
    "how.step1.title":"Quick onboarding","how.step1.desc":"Tell us goals, routine and preferences — Shape+ creates your plan.",
    "how.step2.title":"Adaptive plan","how.step2.desc":"Calorie targets, micro-habits and meal suggestions that adapt as you progress.",
    "how.step3.title":"Smart tracking","how.step3.desc":"Log meals, sync steps and sleep; receive daily feedback and recommendations.",
    "features.title":"Key features","features.subtitle":"Everything you need to lose weight sustainably.",
    "features.f1.title":"Personalized plan","features.f1.desc":"Targets and meals tailored to your metabolism and routine.",
    "features.f2.title":"Quick logging","features.f2.desc":"Food entry in 3 seconds and barcode scanner.",
    "features.f3.title":"Wearable sync","features.f3.desc":"Sync steps, calories burned and sleep automatically.",
    "features.f4.title":"Micro-habits","features.f4.desc":"Small daily actions that accumulate into big results.",
    "features.f5.title":"Visual reports","features.f5.desc":"Charts and cohort insights to follow your progress.",
    "features.f6.title":"Privacy & security","features.f6.desc":"Encryption in transit & at rest; export or delete your data anytime.",
    "testimonials.title":"What users say",
    "plans.title":"Pricing","plans.subtitle":"Start free — upgrade for advanced features.",
    "plans.free":"Free","plans.free1":"Meal logging","plans.free2":"Weight tracking","plans.free3":"1 personalized micro-habit","plans.startFree":"Start free",
    "plans.premium":"Premium","plans.premium1":"Everything in Free","plans.premium2":"Adaptive meal plans","plans.premium3":"Advanced reports","plans.subscribe":"Subscribe Premium",
    "plans.coaching":"Coaching","plans.coaching1":"Dedicated coach","plans.coaching2":"Meal & training plan","plans.contact":"Tell me more",
    "download.title":"Ready to get started?","download.subtitle":"Download Shape+ and start your sustainable weight-loss journey. 7-day free Premium trial.","download.beta":"Prefer beta? Sign up","lead.title":"Receive the link","lead.send":"Send link","lead.note":"We'll send the download link and news to your email.",
    "modal.title":"How would you like to get the app?"
  },
  "es":{
    "nav.features":"Recursos","nav.how":"Cómo funciona","nav.plans":"Planes","nav.testimonials":"Testimonios","nav.getApp":"Descargar",
    "hero.title":"Pierde peso sin dietas extremas — planes personalizados","hero.subtitle":"Shape+ combina nutrición, micro-hábitos y feedback diario para resultados reales. Sincroniza con Apple Health y Google Fit.","hero.ctaPrimary":"Descargar ahora","hero.ctaSecondary":"Cómo funciona",
    "hero.b1":"Planes adaptativos basados en tu historial","hero.b2":"Registro rápido de comidas y escáner","hero.b3":"Integración con wearables y gráficos de progreso",
    "trust.users":"Usuarios activos","trust.rating":"Valoración media","trust.results":"Reducción media de peso en 8 semanas",
    "how.title":"Cómo funciona","how.subtitle":"Del onboarding al progreso: simple, diario y eficaz.",
    "how.step1.title":"Onboarding rápido","how.step1.desc":"Indica objetivos, rutina y preferencias — Shape+ crea tu punto de partida.",
    "how.step2.title":"Plan adaptativo","how.step2.desc":"Objetivos de calorías, micro-hábitos y sugerencias de comidas que se ajustan.",
    "how.step3.title":"Tracking inteligente","how.step3.desc":"Registra comidas, sincroniza pasos y sueño; recibe feedback diario.",
    "features.title":"Recursos principales","features.subtitle":"Todo lo necesario para perder peso de forma sostenible.",
    "features.f1.title":"Plan personalizado","features.f1.desc":"Metas y comidas adaptadas a tu metabolismo y rutina.",
    "features.f2.title":"Registro rápido","features.f2.desc":"Entrada de alimentos en 3 segundos y escáner de código de barras.",
    "features.f3.title":"Integración con wearables","features.f3.desc":"Sincroniza pasos, calorías y sueño automáticamente.",
    "features.f4.title":"Micro-hábitos","features.f4.desc":"Pequeñas acciones diarias que se acumulan en grandes resultados.",
    "features.f5.title":"Informes visuales","features.f5.desc":"Gráficos y cohortes para entender tu evolución.",
    "features.f6.title":"Privacidad y seguridad","features.f6.desc":"Cifrado y opciones para exportar/eliminar datos.",
    "testimonials.title":"Qué dicen los usuarios",
    "plans.title":"Planes","plans.subtitle":"Comienza gratis — actualiza para funciones avanzadas.",
    "plans.free":"Gratis","plans.free1":"Registro de comidas","plans.free2":"Seguimiento de peso","plans.free3":"1 micro-hábito personalizado","plans.startFree":"Comenzar gratis",
    "plans.premium":"Premium","plans.premium1":"Todo en Gratis","plans.premium2":"Planes alimentarios adaptativos","plans.premium3":"Informes avanzados","plans.subscribe":"Suscribirse Premium",
    "plans.coaching":"Coaching","plans.coaching1":"Coach dedicado","plans.coaching2":"Plan alimenticio y de entrenamiento","plans.contact":"Quiero más info",
    "download.title":"¿Listo para empezar?","download.subtitle":"Descarga Shape+ y comienza tu viaje sostenible de pérdida de peso. Prueba Premium por 7 días.","download.beta":"¿Prefieres beta? Regístrate","lead.title":"Recibe el enlace","lead.send":"Enviar enlace","lead.note":"Enviaremos el enlace y novedades a tu correo.",
    "modal.title":"¿Cómo quieres obtener la app?"
  }
};

document.addEventListener('DOMContentLoaded', function(){
  document.getElementById('year').textContent = new Date().getFullYear();

  // mobile menu toggle
  const hamburger = document.getElementById('hamburger');
  const mobileMenu = document.getElementById('mobileMenu');
  hamburger && hamburger.addEventListener('click', ()=> mobileMenu.classList.toggle('show'));

  // modal
  const downloadModal = document.getElementById('downloadModal');
  const modalClose = document.getElementById('modalClose');
  document.getElementById('btnPrimary').addEventListener('click', openModal);
  document.getElementById('ctaHeader').addEventListener('click', openModal);
  modalClose && modalClose.addEventListener('click', closeModal);
  downloadModal && downloadModal.addEventListener('click',(e)=> { if(e.target===downloadModal) closeModal(); });

  // language
  const langSelect = document.getElementById('langSelect');
  const userLang = navigator.language.startsWith('es') ? 'es' : (navigator.language.startsWith('en') ? 'en' : 'pt-BR');
  langSelect.value = userLang;
  applyLanguage(langSelect.value);
  langSelect.addEventListener('change', (e)=> applyLanguage(e.target.value));

  // lead form
  document.getElementById('lead').addEventListener('submit', submitLead);

  // placeholder store links (replace with real store URLs)
  document.getElementById('modalAppStore').href = "#";
  document.getElementById('modalPlayStore').href = "#";
  document.getElementById('modalApk').addEventListener('click', (e)=> {
    e.preventDefault();
    const email = prompt("Digite seu e-mail para receber o APK:");
    if(email && validateEmail(email)) alert("Obrigado! Enviaremos o link para " + email);
  });
});

function applyLanguage(lang){
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const key = el.getAttribute('data-i18n');
    if(i18n[lang] && i18n[lang][key]) {
      if(el.tagName.toLowerCase()==='input' || el.tagName.toLowerCase()==='textarea') el.placeholder = i18n[lang][key];
      else el.innerHTML = i18n[lang][key];
    }
  });
}

function openModal(){ document.getElementById('downloadModal').setAttribute('aria-hidden','false'); }
function closeModal(){ document.getElementById('downloadModal').setAttribute('aria-hidden','true'); }

function validateEmail(email){ return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email); }
function submitLead(e){
  e.preventDefault();
  const email = document.getElementById('email').value;
  const platform = document.getElementById('platform') ? document.getElementById('platform').value : 'both';
  if(!validateEmail(email)){ alert('Digite um e-mail válido.'); return false; }
  alert(`Obrigado! Em breve enviaremos o link para ${email} (${platform}).`);
  e.target.reset();
  return false;
}
